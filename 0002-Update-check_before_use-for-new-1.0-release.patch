From 057e29a426ba299d49293366a049bd89dcc31289 Mon Sep 17 00:00:00 2001
From: Mark Harvey <markh794@gmail.com>
Date: Sun, 4 Sep 2011 12:54:30 +1000
Subject: Update check_before_use for new 1.0 release

Signed-off-by: Mark Harvey <markh794@gmail.com>
---
 scripts/check_before_use.sh |   12 +++++++++---
 1 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/scripts/check_before_use.sh b/scripts/check_before_use.sh
index 90670f4..a8ad0b1 100755
--- a/scripts/check_before_use.sh
+++ b/scripts/check_before_use.sh
@@ -1,10 +1,16 @@
 testmhvtl()
 {
+MAJORVER="1"
 MINRELEASE="17"
 MINVERSION="15"
-RELEASE=`sudo -u root -S vtlcmd -V| cut -d ":" -f2|cut -d "." -f2`
-VERSION=`sudo -u root -S vtlcmd -V| cut -d ":" -f2|cut -d "." -f3| cut -d"-" -f1`
-if [ $RELEASE -gt $MINRELEASE ] && [ $VERSION -gt $MINVERSION ] ; then
+_RELEASE=`sudo -u root -S vtlcmd -V| awk '{print $2}'`
+MAJ=`echo $_RELEASE|awk -F. '{print $1}'`
+RELEASE=`echo $_RELEASE|awk -F. '{print $2}'`
+VERSION=`echo $_RELEASE|awk -F. '{print $3}'`
+if [ $MAJORVER -eq $MAJ ]; then # Version 1.0 is OK
+	echo '<img src="html/images/green_light.png" align=top />' PASS: MHVTL Version $MAJ.$RELEASE.$VERSION [INSTALLED]
+	echo "PASS" >/tmp/test.required.components.testmhvtl
+elif [ $RELEASE -gt $MINRELEASE ] && [ $VERSION -gt $MINVERSION ] ; then
 echo '<img src="html/images/green_light.png" align=top />' PASS: MHVTL Version $RELEASE.$VERSION [INSTALLED]
 echo "PASS" >/tmp/test.required.components.testmhvtl
 else
-- 
1.7.4.1

